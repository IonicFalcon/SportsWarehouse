import{AJAXRequest}from"./modules/AJAX.min.js";function SubmitRequest(e,t){AJAXRequest(e,t).then(e=>{e.success?(updateCategories(e.data),window.CategoryTable.ajax.reload(),$(".modal.active .close").click()):document.querySelector(".modal.active .error").innerText=e.data})}function updateCategories(e){let t=document.querySelectorAll("nav.categoryNav > ul");for(const o of t){$(o).empty();for(const t of e)$(o).append(`<li><a href="searchProducts.php?cat=${t.CategoryID}">${t.CategoryName}</a></li>`)}}$(document).ready(function(){window.CategoryTable=$("#categories").DataTable({responsive:!0,ajax:"controllers/editCategoryController.php",columns:[{data:"CategoryID"},{data:"CategoryName"}]});let e=document.querySelector(".editModal.active");if(e){e.querySelector(".modalBody").getBoundingClientRect().top<0&&e.classList.add("overflow"),document.querySelector(".root").classList.add("modalOpen")}}).click(function(e){let t=document.querySelectorAll("#categories td");t=Array.prototype.slice.call(t);let o=document.querySelector(".contextMenu");t.includes(e.target)||o.classList.remove("active")}),$("#categories tbody").on("click","tr",function(e){let t=document.querySelector(".contextMenu");t.classList.add("active");let o=[];$(e.target).parent().children().each(function(){o.push(this.innerText)});let a=document.querySelectorAll(".contextMenu input[type='hidden']");for(let e=0;e<a.length;e++)a[e].value=o[e];let c=e.target.getBoundingClientRect(),l=c.y+window.scrollY+c.height/2,r=e.pageX+24+"px",d=l-24+"px";t.style.left=r,t.style.top=d}).on("dblclick","tr",function(){window.location.href="editItem.php?cat="+document.querySelector("#rowID").value}),$(".contextMenu .add.iconButton").click(e=>{e.preventDefault(),document.querySelector(".addModal").classList.add("active"),document.querySelector(".root").classList.add("modalOpen")}),$(".contextMenu .edit.iconButton").click(e=>{e.preventDefault(),document.querySelector(".editModal").classList.add("active"),document.querySelector(".root").classList.add("modalOpen"),document.querySelector("#categoryName_edit").value=document.querySelector("#rowName").value}),$(".contextMenu .delete.iconButton").click(e=>{e.preventDefault(),document.querySelector(".deleteModal").classList.add("active"),document.querySelector(".root").classList.add("modalOpen")}),$(".modal .close").click(e=>{e.preventDefault(),$(e.target).parents(".modal")[0].classList.remove("active"),document.querySelector(".root").classList.remove("modalOpen")}),$("#add").click(e=>{e.preventDefault();let t=document.querySelector("#categoryName_add").value;if(0==t.trim().length)return!1;SubmitRequest($(".addModal form").attr("action"),{categoryName:t,method:"Add"})}),$("#edit").click(e=>{e.preventDefault();let t=document.querySelector("#rowName").value,o=document.querySelector("#categoryName_edit").value;return o!==t&&(0!=o.trim().length&&void SubmitRequest($(".editModal form").attr("action"),{categoryID:document.querySelector("#rowID").value,categoryName:o,method:"Edit"}))}),$("#delete").click(e=>{e.preventDefault(),SubmitRequest($(".deleteModal form").attr("action"),{categoryID:document.querySelector("#rowID").value,method:"Delete"})});