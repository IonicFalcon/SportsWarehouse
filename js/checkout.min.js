import{AJAXRequest}from"./modules/AJAX.min.js";function ShippingInfoValidation(){let e=document.querySelectorAll("#shippingInfo input"),t=[];for(let n of e)if($(n).siblings()[1].innerText="",null===n.value||""===n.value.trim()){let e=[n,"- Field must contain a value.\n"];t.push(e)}if(0===t.length)return!0;for(let e of t)$(e[0]).siblings()[1].innerText=e[1];return!1}function PaymentInfoValidation(){let e=document.querySelectorAll("#paymentInfo input"),t=[];for(let n of e)if($(n).siblings()[1].innerText="",null===n.value||""===n.value.trim()){let e=[n,"- Field must contain a value"];t.push(e)}let n=e[0];if(!ValidateCreditCard(n.value)){let e=[n,"- Credit card is invalid"];t.push(e)}let l=e[1],i=e[2];if(l.value<0||l.value>12){let e=[l,"- Invalid Month"];t.push(e)}if(parseInt(i.value)<parseInt((new Date).getFullYear().toString().substr(-2))){let e=[i,"- Card has expired"];t.push(e)}if(parseInt(l.value)<(new Date).getMonth+1&&parseInt(i.value)==parseInt((new Date).getFullYear().toString().substr(-2))){let e=[l,"- Card has expired"];t.push(e)}let a=e[3];if(3!=a.value.length){let e=[a,"- Invalid CVV"];t.push(e)}if(0===t.length)return!0;for(let e of t)$(e[0]).siblings()[1].innerText=e[1];return!1}function ValidateCreditCard(e){if(16!=e.length)return!1;let t=e.split(""),n=0;for(let e=0;e<t.length;e++)e%2==0&&(t[e]*=2,t[e]>9&&(t[e]-=9)),n+=parseInt(t[e]);return n%10==0}$(".collapsible").click(function(){let e=$(this).siblings()[0];this.classList.toggle("collapsed"),e.classList.toggle("collapsed")}),$("#gotoPayment").click(function(){if(!ShippingInfoValidation())return!1;let e=$(this).parents().siblings()[3],t=document.querySelector(".paymentDetails > h2");e.click(),t.click(),document.querySelector("#creditCard").focus()}),$("#placeOrder").click(function(){if(!ShippingInfoValidation()||!PaymentInfoValidation())return!1;let e=new FormData(document.querySelector("#shippingInfo"));e.append("AJAXHalf",!0);let t=$("#shippingInfo").attr("action");AJAXRequest(t,e).then(()=>{document.querySelector("#paymentInfo").submit()})});